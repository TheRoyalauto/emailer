{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 47, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/swizz/Desktop/Emailer/emailer/src/app/api/track/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\n\r\n// 1x1 transparent GIF\r\nconst TRACKING_PIXEL = Buffer.from(\r\n    \"R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\",\r\n    \"base64\"\r\n);\r\n\r\n// This endpoint serves a tracking pixel and can be used to track email opens\r\n// Usage: <img src=\"/api/track?id=CONTACT_ID&c=CAMPAIGN_ID\" width=\"1\" height=\"1\" />\r\nexport async function GET(request: NextRequest) {\r\n    const searchParams = request.nextUrl.searchParams;\r\n    const contactId = searchParams.get(\"id\");\r\n    const campaignId = searchParams.get(\"c\");\r\n\r\n    // Log the open event\r\n    // In production, you would:\r\n    // 1. Call a Convex HTTP action to log this event\r\n    // 2. Store the IP, user agent, timestamp, etc.\r\n    // 3. Update the email's opened status\r\n\r\n    console.log(\"Email opened:\", {\r\n        contactId,\r\n        campaignId,\r\n        timestamp: new Date().toISOString(),\r\n        ip: request.headers.get(\"x-forwarded-for\") || \"unknown\",\r\n        userAgent: request.headers.get(\"user-agent\"),\r\n    });\r\n\r\n    // For real tracking, you'd call your Convex backend here\r\n    // await fetch(`${process.env.NEXT_PUBLIC_CONVEX_URL}/api/track-open`, {\r\n    //     method: 'POST',\r\n    //     body: JSON.stringify({ contactId, campaignId })\r\n    // });\r\n\r\n    // Return transparent 1x1 GIF\r\n    return new NextResponse(TRACKING_PIXEL, {\r\n        headers: {\r\n            \"Content-Type\": \"image/gif\",\r\n            \"Cache-Control\": \"no-cache, no-store, must-revalidate\",\r\n            \"Pragma\": \"no-cache\",\r\n            \"Expires\": \"0\",\r\n        },\r\n    });\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAEA,sBAAsB;AACtB,MAAM,iBAAiB,OAAO,IAAI,CAC9B,4DACA;AAKG,eAAe,IAAI,OAAoB;IAC1C,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;IACjD,MAAM,YAAY,aAAa,GAAG,CAAC;IACnC,MAAM,aAAa,aAAa,GAAG,CAAC;IAEpC,qBAAqB;IACrB,4BAA4B;IAC5B,iDAAiD;IACjD,+CAA+C;IAC/C,sCAAsC;IAEtC,QAAQ,GAAG,CAAC,iBAAiB;QACzB;QACA;QACA,WAAW,IAAI,OAAO,WAAW;QACjC,IAAI,QAAQ,OAAO,CAAC,GAAG,CAAC,sBAAsB;QAC9C,WAAW,QAAQ,OAAO,CAAC,GAAG,CAAC;IACnC;IAEA,yDAAyD;IACzD,wEAAwE;IACxE,sBAAsB;IACtB,sDAAsD;IACtD,MAAM;IAEN,6BAA6B;IAC7B,OAAO,IAAI,gIAAA,CAAA,eAAY,CAAC,gBAAgB;QACpC,SAAS;YACL,gBAAgB;YAChB,iBAAiB;YACjB,UAAU;YACV,WAAW;QACf;IACJ;AACJ"}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}